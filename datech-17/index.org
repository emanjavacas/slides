#+TITLE: Enabling Annotation of Historical Corpora in an Asynchronous Collaborative Environment
#+AUTHOR: Enrique Manjavacas & Peter Petré
#+DATE: DATECH17; 01/06/2017; Göttingen
#+LINK: https://emanjavacas.github.com/slides/datech17
#+REVEAL_ROOT: ../
#+OPTIONS: reveal_center:t reveal_progress:t reveal_history:t reveal_control:t
#+OPTIONS: reveal_rolling_links:nil reveal_keyboard:t reveal_overview:t num:1
#+OPTIONS: reveal_width:1200 reveal_height:800
#+OPTIONS: toc:nil
#+OPTIONS: timestamp:nil
#+OPTIONS: reveal_title_slide:"<h1>%t</h1><h2>%a</h2><h4>%d</h4><p>https://emanjavacas.github.com/slides/datech17</p>"
#+REVEAL_MARGIN: 0.05
#+REVEAL_MIN_SCALE: 0.5
#+REVEAL_MAX_SCALE: 2.5
#+REVEAL_TRANS: nil
#+REVEAL_SPEED: fast
#+REVEAL_THEME: white
#+REVEAL_HLEVEL: 2
#+REVEAL_EXTRA_CSS: ./extra_collaborative.css

* Introduction

** Context
#+BEGIN_NOTES

#+END_NOTES

#+attr_reveal: :frag (roll-in)
- [[https://www.uantwerpen.be/en/projects/mind-bending-grammars/][Mind-bending grammars]] (ERC-project on grammar changes in adults)
  #+attr_reveal: :frag (roll-in)
  - How much innovation across the lifespan?
  - Who innovates and why?
  - For social or cognitive reasons?
- Annotation of the EMMA Corpus [[http://www.helsinki.fi/varieng/CoRD/corpora/EMMA/][Early-Modern Multiloquent Authors]]
  #+attr_reveal: :frag (roll-in)
  - 100m words of 17th/18th Century English
  - Metadata (author, date, genre, generation)

** My Goals
#+BEGIN_NOTES
- Improve a poor corpus-linguist's research environment
- In a considerable amount of time, (single person project)
#+END_NOTES

#+attr_reveal: :frag (roll-in)
- Improving Corpus-Linguistics Research
- Simplifying Developement of Corpus Query/Annotation tools

* Improving Corpus-Linguistics Research

** Annotation-based Corpus Linguistics

#+attr_reveal: :frag (roll-in)
  - Corpus Query \Rightarrow hits
  - Filter False Positives
  - Add Linguistic Annotation
  - Quantitative Analysis

** Problems
 - Linkage problem
 - Synchronization problem

** Linkage problem


*** Typical Corpus Linguistics Workflow
     #+BEGIN_NOTES
     - Once hits have been extracted/annotated, back-pointers to the corpus are missing.
     - Inspect the context around the hit
     - Attach previous annotations to the hit
     #+END_NOTES

    #+attr_reveal: :frag roll-in
    [[./img/querytospread.png]]
    #+attr_reveal: :frag roll-in
    [[./img/spreadtoquery.png]]

*** Drawback
    Spread of non-reusable data

** Synchronization problems 

   *in multi-user, real-time environments*

   #+BEGIN_NOTES
   Annotations are being created by different researchers and have to derive in
   a coherent set (same tags, labels used with the same meaning, etc...).
   #+END_NOTES

   #+attr_reveal: :frag (roll-in)
   - _Intrinsic_: related to the linguistic annotation process itself
   - _Extrinsic_: related to software synchronization challenges

** Intrinsic

   Unifying annotation schemes and their usage

   #+BEGIN_NOTES
   Annotation schemes (ling. categories, tagsets) are typically open in CL
   #+END_NOTES

   #+attr_reveal: :frag (roll-in)
   - Modification of tagsets (create, remove & change tags)
   - Interpretational disagreements (spotting & correcting)

** Extrinsic
Fundamental problem of collaborative software/distributed systems

#+attr_reveal: :frag roll-in
#+BEGIN_QUOTE
"How to ensure that dispersed users are able to modify a shared body of 
documents without overwriting each other's changes"
#+END_QUOTE

* Simplifying Developement of Corpus Query/Annotation tools

** Current issues

#+BEGIN_NOTES
- Thinking about CQPWeb (which I know better) and ANNIS (which I tried to use)
(Perhaps this isn't up to date, but it certainly was 18 months ago)
- CQPWeb (very user-friendly, very programmer unfriendly)
- CQP (very old protocol no open-source implementations)
#+END_NOTES

#+attr_reveal: :frag (roll-in)
- End-to-end monolithic tools \Rightarrow hard to adapt & integrate 
- Public APIs for programmers are typically missing
- *Result* \Rightarrow Lots of rewriting, redundant tools

** Solutions

#+BEGIN_NOTES
- Bad news: we haven't solved the issue, but hopefully we haven't made it worse
#+END_NOTES

#+attr_reveal: :frag (roll-in)
- Modular design + Interface programming in corpus-tool developement
- Explicit separation of front-end and back-end logic (e.g. BlackLab)

* CosyCat
*Collaborative Synchronized Corpus Annotation Tool*

#+BEGIN_HTML
<a href="https://www.github.com/emanjavacas/cosycat">https://www.github.com/emanjavacas/cosycat</a>
#+END_HTML

#+BEGIN_HTML
<br/>
<br/>
#+END_HTML

#+attr_reveal: :frag (roll-in)
- Written in Clojure/ClojureScript
- Open source (Eclipse Public License)

** 
   :PROPERTIES:
   :reveal_background: ./img/app-screenshot.jpg
   :END:
    
** What does it do?

   #+BEGIN_NOTES
   - Address the mentioned issues, but more concretely...
   - Three options: (build own non-decoupled, build decoupled, build the app in a way that is easy to adapt other people's decoupled tools)
   #+END_NOTES
   
   #+attr_reveal: :frag (roll-in)
   - Encompass *Corpus Query Engine* + *Annotation Interface*
   - Enable *synchronized real-time multi-user annotation* of text
   - Follow *modular design* for easy reusability/adaptation of pre-exisiting tools

** Architecture

#+BEGIN_NOTES
Drawing inspiration from GitHub, and adding multi-user real-time features
#+END_NOTES

[[./img/app-remote.jpg]]

*** Web-based Client

#+REVEAL: split

#+BEGIN_NOTES
Messaging pattern where senders (publishers), do not directly message specific receivers (subscribers), but instead characterize messages into classes without knowledge of which subscribers, if any, there may be. Similarly, subscribers express interest in one or more classes and only receive messages that are of interest, without knowledge of which publishers, if any, there are.
#+END_NOTES

Real-time feedback client-to-client following a *Pub/Sub* architecture
[[./img/project.png]]

#+REVEAL: split
Subscribers are assigned roles & permissions (resource access control)
[[./img/project_roles.png]]

#+REVEAL: split
Conflicts are explicitely resolved and documented using threads
#+BEGIN_HTML
<div style="overflow:hidden">
<img src="./img/conflict_resolution.png" height="100%"/>
</div>
#+END_HTML

*** Annotation Database

#+REVEAL: split
Support for Token & Span annotations

#+BEGIN_HTML
<div style="float:left;width:100%">
<div style="float:left;font-size:1.2em">Token
<pre class="src src-js" style="width:100%">{
    <span style="color: #CC9393;">"ann"</span> : {
            <span style="color: #CC9393;">"key"</span> : <span style="color: #CC9393;">"pret"</span>,
            <span style="color: #CC9393;">"value"</span> : <span style="color: #CC9393;">"s"</span>
    },
    <span style="color: #CC9393;">"corpus"</span> : <span style="color: #CC9393;">"mbg-index"</span>,
    <span style="color: #CC9393;">"query"</span> : <span style="color: #CC9393;">"'gat'"</span>,
    <span style="color: #CC9393;">"span"</span> : {
            <span style="color: #CC9393;">"type"</span> : <span style="color: #CC9393;">"token"</span>,
            <span style="color: #CC9393;">"scope"</span> : 133601,
            <span style="color: #CC9393;">"doc"</span> : <span style="color: #CC9393;">"A01342"</span>
    },
    <span style="color: #CC9393;">"timestamp"</span> : 1476095003208,
    <span style="color: #CC9393;">"username"</span> : <span style="color: #CC9393;">"OscarStrik"</span>,
    <span style="color: #CC9393;">"version"</span> : 0
}
</pre>
</div>
<div style="float:right;margin-left:5px;font-size:1.2em">Span
<pre class="src src-js" style="width:100%">{
    <span style="color: #CC9393;">"ann"</span> : {
            <span style="color: #CC9393;">"key"</span> : <span style="color: #CC9393;">"cxnele"</span>,
            <span style="color: #CC9393;">"value"</span> : <span style="color: #CC9393;">"getobj"</span>
    },
    <span style="color: #CC9393;">"corpus"</span> : <span style="color: #CC9393;">"mbg-index"</span>,
    <span style="color: #CC9393;">"query"</span> : <span style="color: #CC9393;">"'gat'"</span>,
    <span style="color: #CC9393;">"span"</span> : {
            <span style="color: #CC9393;">"type"</span> : <span style="color: #CC9393;">"IOB"</span>,
            <span style="color: #CC9393;">"scope"</span> : {
                    <span style="color: #CC9393;">"B"</span> : 3222,
                    <span style="color: #CC9393;">"O"</span> : 3224
            },
            <span style="color: #CC9393;">"doc"</span> : <span style="color: #CC9393;">"99863288"</span>
    },
    <span style="color: #CC9393;">"timestamp"</span> : 1476095439636,
    <span style="color: #CC9393;">"username"</span> : <span style="color: #CC9393;">"OscarStrik"</span>,
    <span style="color: #CC9393;">"version"</span> : 0
}
</pre>
</div>
</div>

#+END_HTML

#+REVEAL: split
Version-controlled: Each annotation has a revision history
[[./img/span_pane.png]]

*** Corpus-query engine

#+attr_reveal: :frag (roll-in)
- Decoupling of Front-end and Query-engine

#+REVEAL: split
[[./img/app-remote.jpg]]

#+REVEAL: split
#+attr_reveal: :frag (none none roll-in)
- Decoupling of Front-end and Query-engine
- Currently support for [[https://www.github.com/INL/BlackLab][BlackLab Server]]
- Ongoing work on support for [[http://cwb.sourceforge.net/][CQP]]

# ** Added advantages
#  #+attr_reveal: :frag (roll-in)
#  - Structured annotation data:
#    - To what extent can linguistic annotation be automated.
#  - Reciprocal supervision (Am I using the categories as my peers do?)

* Remaining Challenges

** Incremental Indexing of Corpus Annotations

#+attr_reveal: :frag (roll-in)
- How to make the corpus query engine aware of the new annotations?

** Scale

#+attr_reveal: :frag (roll-in)
- Support large user groups (Currently working with some few dozens)

* Thank you for your attention

#+BEGIN_HTML
<div style="text-align:center;display:inline-block">
    <div style="float:left">
        <img src="./img/erc.jpg" height="200"/>
    </div>
    <div style="float:left">
        <img src="./img/MBG_logo.png" height="200"/>
    </div>
    <div style="float:left">
        <img src="./img/ua.jpg" height="200"/>
    </div>
</div>
#+END_HTML
